{% extends 'auction/base.html' %}

{% block content %}
<h3 class="entity">Item {{item.code}}: {{item.name}}</h3>

<form class="entity edit" action="{{item.get_absolute_url}}/edit" method="get">{% csrf_token %}
<input type="submit" value="Edit" />
</form>

<form class="entity delete" action="{{item.get_absolute_url}}/delete" method="post">{% csrf_token %}
<input type="submit" value="Delete" onClick="return confirm('Are you sure you want to delete this item and all the purchases of this item?')"/>
</form>
<br/>
Unit Price: ${{item.unit_price|floatformat:2}}<br/>
{{item.quantity_sold}} sold<br/>
{{item.quantity_remaining_str}} remaining<br/>

<p>
{% if item.quantity_sold > 0 %}
    <h3>People who purchased this item:</h3>
    <ul>
    {% for purchase in item.purchases.all %}
    <li>
        <a href="{{purchase.bidder.get_absolute_url}}">{{purchase.bidder.code}}, {{purchase.bidder.name}}</a>
    </li>
    {% endfor %}
    </ul>
{% endif %}
{% if item.quantity_remaining != 0 %}
<div class="action">
    <h3>Purchase item:</h3>
    <form action="{{item.get_absolute_url}}/purchase_item" method="post">{% csrf_token %}
    {{purchase_form.as_p}}
    <input type="submit" value="Submit" />
    </form>
</div>
{% endif %}
{% endblock %}
